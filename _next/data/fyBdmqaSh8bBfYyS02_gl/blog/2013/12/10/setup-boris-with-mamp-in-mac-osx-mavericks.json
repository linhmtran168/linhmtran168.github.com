{"pageProps":{"article":{"title":"Setup boris with MAMP in Mac OSX Mavericks","slug":["2013","12","10","setup-boris-with-mamp-in-mac-osx-mavericks"],"uri":"2013/12/10/setup-boris-with-mamp-in-mac-osx-mavericks","updatedTime":"2013/12/10","content":"<p>For me who is used to having REPL as an essential tools for development, <a href=\"https://github.com/d11wtq/boris\">Boris</a> is a must have when developing PHP web app.\nBut after updating to MAMP 2.0 and PHP 5.5.3, it stopped working. There is no error output, the REPL just doesn't appear.\nAfter several hours of googling, I found out the reason is that MAMP's PHP is built with out <strong>pcntl</strong> and <strong>readline</strong> support, which boris depends on. To get those features, there is no other way then manually compile and add them to MAMP's PHP installation.</p>\n<p>First, we need to download the source code for MAMP's PHP. In my case it's PHP 5.5.3</p>\n<pre><code class=\"hljs language-sh\">$ php -v\nCopyright (c) 1997-2013 The PHP Group\nZend Engine v2.5.0, Copyright (c) 1998-2013 Zend Technologies\n    with Zend OPcache v7.0.3-dev, Copyright (c) 1999-2013, by Zend Technologies\n\n$ wget http://museum.php.net/php5/php-5.5.3.tar.gz\n$ tar -xzvf php-5.5.3.tar.gz\n</code></pre>\n<p>After that change the folder name to <em><strong>php</strong></em> and move it <em><strong>include</strong></em> folder in MAMP's PHP 5.5.3 folder</p>\n<pre><code class=\"hljs language-sh\">$ mv php-5.5.3 php\n$ mkdir -p /Applications/MAMP/bin/php/php5.5.3/include\n$ mv php /Applications/MAMP/bin/php/php5.5.3/include\n</code></pre>\n<p>Then, use the configure it to prepare all the necessary header files</p>\n<pre><code class=\"hljs language-sh\">$ mv php-5.5.3 php\n$ <span class=\"hljs-built_in\">cd</span> /Applications/MAMP/bin/php/php5.5.3/include/php\n$ ./configure\n</code></pre>\n<p>Now, we process to build the <strong>pcntl</strong> and <strong>readline</strong> extension.\nBut before that, we must set some flags so that they are compiled with dual 32bit and 64bit architecture as MAMP PHP was built this way.</p>\n<pre><code class=\"hljs language-sh\">$ MACOSX_DEPLOYMENT_TARGET=10.9\n$ CFLAGS=<span class=\"hljs-string\">\"-arch i386 -arch x86_64 -g -Os -pipe -no-cpp-precomp\"</span>\n$ CCFLAGS=<span class=\"hljs-string\">\"-arch i386 -arch x86_64 -g -Os -pipe\"</span>\n$ CXXFLAGS=<span class=\"hljs-string\">\"-arch i386 -arch x86_64 -g -Os -pipe\"</span>\n$ LDFLAGS=<span class=\"hljs-string\">\"-arch i386 -arch x86_64 -bind_at_load\"</span>\n$ <span class=\"hljs-built_in\">export</span> CFLAGS CXXFLAGS LDFLAGS CCFLAGS MACOSX_DEPLOYMENT_TARGET\n</code></pre>\n<p>Now, what left is compiling the extensions, move the compiled <em><strong>.so</strong></em> files to MAMP's PHP extensions directory:</p>\n<pre><code class=\"hljs language-sh\">$ <span class=\"hljs-built_in\">cd</span> ext/pcntl\n$ phpize\n$ ./configure\n$ make\n$ cp modules/pcntl.so /Applications/MAMP/bin/php/php5.5.3/lib/php/extensions/no-debug-non-zts-20121212\n$ <span class=\"hljs-built_in\">cd</span> ../readline\n$ phpize\n$ ./configure\n$ make\n$ cp modules/readline.so /Applications/MAMP/bin/php/php5.5.3/lib/php/extensions/no-debug-non-zts-20121212\n</code></pre>\n<p>Finally edit the MAMP's PHP php.ini file to include those extensions</p>\n<pre><code class=\"hljs language-sh\">$ <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"extension=pcntl.so\\nextension=readline.so\"</span> >> /Applications/MAMP/bin/php/php5.5.3/conf/php.ini\n</code></pre>\n<p>Now we are done, just install boris if you haven't done so and enjoy playing PHP code in the terminal</p>\n<pre><code class=\"hljs language-sh\">$ brew install boris\n$ boris\n[1] boris> <span class=\"hljs-built_in\">echo</span> <span class=\"hljs-string\">\"Hello World!\\n\"</span>;\nHello World!\n[2] boris>\n</code></pre>"}},"__N_SSG":true}